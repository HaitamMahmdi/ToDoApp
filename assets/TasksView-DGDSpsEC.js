import{f as P,G as H,H as q,k as Y,c as r,h as n,o as a,a as s,A as T,j as g,t as x,D as N,n as l,i as S,q as A,m as L,u as W,z as O,F as V,x as F,y as J,b as B,g as K,v as Q}from"./index-FOUCMNTT.js";const G="/ToDoApp/assets/taskImage-CjpjrEBD.jpg";function U(t,d){let c=!1;const y=m=>{c&&t.value&&!t.value.contains(m.target)&&d()};return setTimeout(()=>{c=!0},0),document.addEventListener("click",y),()=>{document.removeEventListener("click",y)}}const X=["id"],Z={class:"py-1 px-1 flex flex-col justify-center grow"},_={class:"flex items-center flex-wrap"},tt=["aria-label"],et={class:"text-tiny ml-"},st={class:"relative"},at={key:0,class:"absolute w-52 z-10 bg-secondary left-[-10rem] top-full"},ot={class:"mt-5 w-full max-sm:hidden flex text-[12px] justify-between"},lt={class:"mt-5 text-center px-1 max-sm:flex w-full hidden text-[12px] justify-between"},nt={class:"px-1"},E={__name:"TaskCom",props:{taskobj:Object},emits:["startTask","removeTask","stopTask","markAsDone","show-info","taskIsFailed"],setup(t,{emit:d}){var p;const c=d,y=i=>{c("show-info",t.taskobj)};let m=t.taskobj.status;const f=t.taskobj.id,I=()=>{c("startTask",{id:f,status:m})},j=()=>{c("stopTask",{id:f,status:m})},w=()=>{c("markAsDone",{id:f,status:m})},C=()=>{c("removeTask",{id:f,status:m})},v=P(!1),D=P(null);let u;(+t.taskobj.inProgressAt.split("-")[2]<+new Date().getDate()||((p=t.taskobj)==null?void 0:p.deadline.split("-")[2])<+new Date().getDate())&&(console.log(t.taskobj),t.taskobj.status="failed",c("taskIsFailed",t.taskobj.id)),H(()=>{u=U(D,()=>{v.value=!1})}),q(()=>{u==null||u()});const o=i=>{if(i.currentTarget.id==="optionToggle")return v.value=!0},b=((i,e=240)=>{if(i=i.replace("#","").trim(),i.length!==6)return!1;const k=parseInt(i.slice(0,2),16),R=parseInt(i.slice(2,4),16),$=parseInt(i.slice(4,6),16);return k>e&&R>e&&$>e})(t.taskobj.categoryColor,240);return(i,e)=>{const k=Y("font-awesome-icon");return t.taskobj.status!=="done"?(a(),r("div",L({key:0,id:`taskCard-${l(f)}`},i.$attrs,{class:"dark:bg-on-surface md:min-w-96 text-light-surface bg-light-secondary h-fit max-sm:p-5 flex mx-4 flex-wrap dark:text-on-primary justify-between mb-5"}),[s("div",Z,[s("div",_,[s("div",{class:T([[t.taskobj.status==="In Progress"||t.taskobj.status==="done"?"bg-Clickable  ":t.taskobj.status==="failed"?"bg-error":"bg-on-primary "],"flex justify-center items-center p-1 w-[2rem] h-[2rem] rounded-full dark:text-on-surface"])},[t.taskobj.status==="In Progress"?(a(),g(k,{key:0,class:T([t.taskobj.status==="In Progress"?"animate-spin text-on-primary":""]),icon:"rotate"},null,8,["class"])):n("",!0),t.taskobj.status!="In Progress"&&t.taskobj.status!="done"&&t.taskobj.status!="failed"?(a(),g(k,{key:1,class:"text-light-secondary dark:text-on-surface",icon:"hourglass-start"})):n("",!0),t.taskobj.status==="done"?(a(),g(k,{key:2,icon:"check",class:"text-on-primary"})):n("",!0),t.taskobj.status==="failed"?(a(),g(k,{key:3,class:"text-on-primary",icon:"xmark"})):n("",!0)],2),s("h2",{"aria-label":t.taskobj.taskName,onClick:y,class:"flex justify-between hover:text-Clickable cursor-pointer ml-2 grow items-center"},[s("span",et,x(t.taskobj.taskName.length>=18?t.taskobj.taskName.slice(0,17)+"...":t.taskobj.taskName),1),s("span",{style:N({"background-color":t.taskobj.categoryColor}),class:T([[l(b)?" text-on-surface ":"text-on-primary"],"rounded-2xl ml-2 p-1"])},"#"+x(t.taskobj.category.length>7?t.taskobj.category.slice(0,7)+"..":t.taskobj.category),7)],8,tt),s("div",st,[s("button",{id:"optionToggle",onClick:o,ref_key:"buttonShowOptions",ref:D,class:"group ml-5 relative cursor-pointer text-tiny"},[S(k,{class:"group-focus:text-Clickable",icon:"ellipsis"})],512),v.value?(a(),r("ul",at,[t.taskobj.status!="done"&&t.taskobj.status!=="In Progress"&&t.taskobj.status!="failed"?(a(),r("li",{key:0,onClick:I,class:"flex items-center cursor-pointer py-2 px-4 hover:bg-primary"},[S(k,{icon:"hourglass-start"}),e[0]||(e[0]=s("p",{class:"ml-2"},"start",-1))])):n("",!0),t.taskobj.status!=="done"&&t.taskobj.status!=="pause"&&t.taskobj.status!=="not started"&&t.taskobj.status!="failed"?(a(),r("li",{key:1,onClick:j,class:"flex items-center cursor-pointer py-2 px-4 hover:bg-primary"},[S(k,{icon:"ban"}),e[1]||(e[1]=s("p",{class:"ml-2"},"stop",-1))])):n("",!0),s("li",{onClick:C,class:"flex items-center cursor-pointer py-2 px-4 hover:bg-primary"},[S(k,{icon:"trash-can"}),e[2]||(e[2]=s("p",{class:"ml-2"},"remove Task",-1))]),t.taskobj.status!=="done"&&t.taskobj.status!="failed"?(a(),r("li",{key:2,onClick:w,class:"flex items-center cursor-pointer py-2 px-4 hover:bg-primary"},[S(k,{icon:"circle-check"}),e[3]||(e[3]=s("p",{class:"ml-2"},"Mark as done",-1))])):n("",!0)])):n("",!0)])]),s("ul",ot,[s("li",null,[e[4]||(e[4]=A(" priority: ")),s("span",{class:T([t.taskobj.priority==="extreme"?"text-error":"",t.taskobj.priority==="moderate"?"text-success":"text-amber-300"])},x(t.taskobj.priority),3)]),s("li",null,"add at: "+x(t.taskobj.addAt),1),s("li",null,[e[5]||(e[5]=A(" status: ")),s("span",{class:T([t.taskobj.status==="In Progress"||t.taskobj.status==="done"?" text-primary":" text-error"])},x(t.taskobj.status),3)])])]),e[8]||(e[8]=s("div",{class:"w-25 ml-2 max-sm:w-full overflow-hidden"},[s("img",{src:G,class:"w-full h-full",alt:""})],-1)),s("ul",lt,[s("li",null,[e[6]||(e[6]=A(" priority: ")),s("span",{class:T([t.taskobj.priority==="Extreme"?"text-error":t.taskobj.priority==="Moderate"?"text-success":"text-amber-300"])},x(t.taskobj.priority),3)]),s("li",nt,"add at: "+x(t.taskobj.addAt),1),s("li",null,[e[7]||(e[7]=A(" status: ")),s("span",{class:T([t.taskobj.status==="In Progress"||t.taskobj.status==="done"?" text-primary":" text-error"])},x(t.taskobj.status),3)])]),s("div",{style:N({width:`${t.taskobj.completionRate}%`}),class:"h-0.5 bg-Clickable"},null,4)],16,X)):n("",!0)}}},rt={class:"w-full my-5"},it={class:"text-[1rem] text-on-primary"},ut={class:""},dt={key:0},ct=["placeholder"],kt={class:"ml-5 text-tiny flex flex-wrap mb-10 items-center"},mt={key:0,class:"flex cursor-pointer items-center mr-4"},ft={key:1,class:"flex items-center"},bt={key:2,class:"flex items-center"},yt={key:1},xt={key:0},pt={key:0,class:"text-tiny mt-10 mb-2 font-semibold"},gt={class:"ml-5"},wt=["id","stepid"],vt={class:"ml-2"},z={__name:"TaskDetailsCom",props:{task:Object},emits:["taskInfoHide","stepIsDone"],setup(t,{emit:d}){W();const c=d,{taskName:y,inProgressAt:m,deadline:f,description:I,priority:j,steps:w,category:C,status:v,addAt:D,id:u,categoryColor:o}=t.task??{},h=P(null);let b;H(async()=>{b=U(h,()=>{console.log("from task details"),c("taskInfoHide")})}),q(()=>{b==null||b()});const p=async i=>{const e=i.currentTarget.id;i.currentTarget.setAttribute("style","display: none !important;"),c("stepIsDone",e,u,v)};return(i,e)=>{var k,R;return a(),r("div",L({ref_key:"taskDetails",ref:h},i.$attrs,{class:"w-full md:w-md top-0 text-on-primary bg-light-secondary border-l border-on-surface h-full overflow-y-scroll fixed z-50 p-5 pt-0 right-0 dark:bg-secondary"}),[s("div",rt,[s("h2",{style:N({color:l(o)}),class:"text-3xl flex justify-between items-center font-semibold"},[A(" #"+x(l(C))+" ",1),s("span",it,x(l(D)),1)],4)]),s("form",{action:"",onSubmit:e[0]||(e[0]=J(()=>{},["prevent"]))},[s("div",ut,[s("div",null,[S(O,{inputType:"text",id:(k=l(y))==null?void 0:k.trim(),name:"",label:"task Name",helperText:!0,placeholder:l(y),addValidateToText:!0,isRequired:"",lableStyle:"text-tiny",class:"mb-5 w-full",cusclass:" w-full   p-4 ",inputReadonly:!0},null,8,["id","placeholder"]),l(m)?(a(),g(O,{key:0,inputType:"text",id:l(m).trim(),name:"inProgressAt",label:"inProgress At",helperText:!0,lableStyle:"text-tiny",placeholder:l(m),addValidateToText:!1,isRequired:"",class:"mb-5",cusclass:"w-full p-4 ",inputReadonly:!0},null,8,["id","placeholder"])):n("",!0),l(f)?(a(),g(O,{key:1,inputType:"text",id:`${(R=l(f))==null?void 0:R.trim()}`,name:"deadline",label:"deadline",helperText:!0,lableStyle:"text-tiny",placeholder:l(f),addValidateToText:!1,isRequired:"",class:"mb-5",cusclass:" w-full  p-4 ",inputReadonly:!0},null,8,["id","placeholder"])):n("",!0)]),e[1]||(e[1]=s("div",{class:"h-96 p-5 w-full"},[s("img",{src:G,class:"w-full h-full",alt:""})],-1))]),l(I)?(a(),r("div",dt,[e[2]||(e[2]=s("h3",{class:"text-tiny mt-10 mb-2 font-semibold"},"Description",-1)),s("textarea",{placeholder:l(I),readonly:"",class:"dark:bg-on-surface mt-4 font-semibold text-tiny h-fit p-5 lg:p-10 w-full",name:"description",id:"description"},null,8,ct)])):n("",!0),s("div",null,[e[6]||(e[6]=s("h3",{class:"text-tiny mt-10 mb-2 font-semibold"},"Priority",-1)),s("ul",kt,[l(j)==="extreme"?(a(),r("li",mt,e[3]||(e[3]=[s("span",{class:"block mr-2 border-2 w-3.5 h-3.5 border-error bg-error p-1 rounded-full"},null,-1),s("p",null,"Extreme",-1)]))):n("",!0),l(j)==="moderate"?(a(),r("li",ft,e[4]||(e[4]=[s("span",{class:"block mr-2 border-2 w-3.5 h-3.5 bg-success border-success p-1 rounded-full"},null,-1),s("p",null,"Moderate",-1)]))):n("",!0),l(j)==="low"?(a(),r("li",bt,e[5]||(e[5]=[s("span",{class:"block mr-2 border-2 w-3.5 h-3.5 bg-amber-300 border-amber-300 p-1 rounded-full"},null,-1),s("p",null,"low",-1)]))):n("",!0)])]),l(v)!=="done"?(a(),r("ul",yt,[l(w).length?(a(),r("li",xt,[l(w)?(a(),r("h3",pt,"steps")):n("",!0),s("ul",gt,[(a(!0),r(V,null,F(l(w),($,M)=>(a(),r("li",{key:$.id,id:$.objID,stepid:$.id,onClick:p,class:T([[M+1===l(w).length?"dark:border-y":"dark:border-t"],"flex py-5 px-3 transition cursor-pointer items-center dark:border-section duration-100 dark:hover:bg-on-surface hover:border-y w-full"])},[e[7]||(e[7]=s("span",{class:"w-3.5 h-3.5 block border rounded-full"},null,-1)),s("p",vt,x($.stepText),1)],10,wt))),128))])])):n("",!0)])):n("",!0)],32)],16)}}},jt={key:0,class:"container md:w-[calc(100%-256px)] min-h-[100vh] flex flex-wrap gap-1.5 justify-center md:p-4 relative mx-auto"},ht={key:0,class:"w-full flex h-fit justify-center items-center flex-wrap"},Tt={key:1,class:"text-[clamp(2.5rem,5vw,3rem)] h-fit mb-10 ml-5 font-bold w-full dark:text-on-primary"},It={key:2,class:"w-full flex flex-wrap h-fit justify-center items-center"},Dt={key:1,class:"container md:w-[calc(100%-256px)] min-h-[100vh] flex flex-wrap gap-1.5 justify-center md:p-4 relative mx-auto"},$t={__name:"TasksView",setup(t){const d=W(),c=B(()=>d.tasks),y=B(()=>d.getTodayTasks),m=P(null),f=P(null),I=async({id:u,status:o})=>{(o==="not started"||o==="pause")&&await d.updateTask(u,"status","In Progress")},j=async({id:u})=>{await d.removeTask(u)},w=async({id:u,status:o})=>{(o!=="not started"||o!=="pause")&&await d.updateTask(u,"status","pause")},C=async({id:u})=>{await d.updateTask(u,"status","done")},v=async(u,o,h)=>{const b=c.value.find(e=>e.id===o),p=b.completionRate+100/b.originalStepsCount,i=b.steps.filter(e=>e.objID!==u);await d.updateTask(o,"steps",i),h!="In Progress"&&await d.updateTask(o,"status","In Progress"),await d.updateTask(o,"completionRate",p),p>=100&&await d.updateTask(o,"status","done"),await d.updateTask(o,"updatedAt",new Date().toISOString())},D=async u=>{await d.updateTask(u,"status","failed")};return(u,o)=>{var h,b,p,i;return(h=c.value)!=null&&h.length?(a(),r("div",jt,[(b=y.value)!=null&&b.length?(a(),r("div",ht,[o[4]||(o[4]=s("h2",{class:"text-[clamp(2.5rem,5vw,3rem)] h-fit mb-10 ml-5 font-bold w-full dark:text-on-primary"}," tody tasks ",-1)),(a(!0),r(V,null,F(y.value,e=>(a(),g(E,{onShowInfo:o[0]||(o[0]=k=>{m.value=k}),class:"lg:w-lg",key:e.id,taskobj:e,onStartTask:I,onRemoveTask:j,onStopTask:w,onTaskIsFailed:D,onMarkAsDone:C},null,8,["taskobj"]))),128)),m.value?(a(),g(z,{key:0,onTaskInfoHide:o[1]||(o[1]=e=>m.value=null),onStepIsDone:v,task:m.value},null,8,["task"])):n("",!0)])):n("",!0),c.value.length!==((p=y.value)==null?void 0:p.length)?(a(),r("h2",Tt," coming tasks ")):n("",!0),c.value.length!==((i=y.value)==null?void 0:i.length)?(a(),r("div",It,[(a(!0),r(V,null,F(c.value,e=>K((a(),g(E,{onShowInfo:o[2]||(o[2]=k=>{f.value=k}),class:"lg:w-lg",key:e.id,taskobj:e,onStartTask:I,onRemoveTask:j,onStopTask:w,onMarkAsDone:C,onTaskIsFailed:D},null,8,["taskobj"])),[[Q,e.inProgressAt!==new Date().toISOString().split("T")[0]]])),128)),f.value?(a(),g(z,{key:0,onTaskInfoHide:o[3]||(o[3]=e=>f.value=null),onStepIsDone:v,task:f.value},null,8,["task"])):n("",!0)])):n("",!0)])):(a(),r("div",Dt,o[5]||(o[5]=[s("div",{class:"h-full flex justify-center items-center"},[s("h1",{class:"dark:text-on-primary text-light-primary font-bold text-[clamp(2rem,5vw,7rem)]"}," You have no tasks ")],-1)])))}}};export{$t as default};
